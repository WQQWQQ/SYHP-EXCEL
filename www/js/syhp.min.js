angular.module("configs",[]).constant("localImgUrl","../img/").constant("serverImgUrl","http://localhost:3333/img/"),angular.module("services",["ngCordova"]).factory("Chats",[function(){var t=[{id:0,name:"Ben Sparrow",lastText:"You on your way?",face:"img/ben.png"},{id:1,name:"Max Lynx",lastText:"Hey, it's me",face:"img/max.png"},{id:2,name:"Adam Bradleyson",lastText:"I should buy a boat",face:"img/adam.jpg"},{id:3,name:"Perry Governor",lastText:"Look at my mukluks!",face:"img/perry.png"},{id:4,name:"Mike Harrington",lastText:"This is wicked good ice cream.",face:"img/mike.png"}];return{all:function(){return t},remove:function(e){t.splice(t.indexOf(e),1)},get:function(e){for(var n=0;n<t.length;n++)if(t[n].id===parseInt(e))return t[n];return null}}}]).factory("$icu",["$ionicHistory","$ionicScrollDelegate","$http","$ionicModal","$ionicPopup","$ionicLoading","$state","$ionicPopover","$location","$ionicActionSheet","$ionicTabsDelegate","$cordovaStatusbar",function(t,e,n,o,i,a,s,c,r,l,u,p){var d=null,h=null;return{platform:ionic.Platform.platform(),alert:function(t,e){d||(d=i.alert({title:t.title||"提示",subTitle:t.subT||null,template:t.tpl,okText:t.text||"我知道啦~",cssClass:t.class||"",okType:t.type})).then(function(){e&&e(),d=null})},confirm:function(t,e,n){d||(d=i.confirm({template:t.tpl,title:t.title||"提示",subTitle:t.subT||null,cancelText:t.cText||"取消",okText:t.oText||"确定",okType:t.oType||"",cancelType:t.cType||"",cssClass:t.class||""})).then(function(t){t?e&&e():n&&n(),d=null})},show:function(t,e){d||(d=i.show({template:t.tpl,title:t.title||"提示",subTitle:t.subT||null,scope:t.scope||null,cssClass:t.class||"",buttons:e}))},sheet:function(t,e,n,o){h=l.show({buttons:t.buttons,cssClass:t.class,cancelOnStateChange:t.flag||!0,destructiveText:t.dText||"删除",titleText:t.title,cancelText:t.cText||"取消",destructiveButtonClicked:function(){o&&o()},cancel:function(){n&&n()},buttonClicked:function(t){return e&&e(t),!0}})},hint:function(t,e){a.show({template:t.tpl||"载入中...",scope:t.scope,noBackdrop:t.bg,delay:t.delay,duration:t.time||2500}).then(function(){e&&e()})},modal:function(t,e,n){o.fromTemplateUrl(t.url,{scope:t.scope,animation:t.animation||"slide-in-up",focusFirstInput:t.focus||!0}).then(function(o){t.scope.modal=o,t.scope.$on("$destroy",function(){t.scope.modal.remove()}),t.scope.$on("modal.hidden",function(){n&&n()}),t.scope.$on("modal.shown",function(){e&&e()})})},popover:function(t,e,n){c.fromTemplate(t.tpl,{scope:t.scope,focusFirstInput:t.focus||!0}).then(function(o){t.scope.popover=o,t.scope.showPopover=function(e){t.scope.popover.show(e)},t.scope.$on("$destroy",function(){t.scope.popover.remove()}),t.scope.$on("popover.shown",function(){e&&e()}),t.scope.$on("popover.hidden",function(){n&&n()})})},clearHistory:function(){t.clearHistory()},back:function(e){t.goBack(e)},go:function(t){s.go(t)},scrollBottom:function(t,n){n?e.$getByHandle(n).scrollBottom(!!t):e.scrollBottom(!!t)},scrollTop:function(t,n){n?e.$getByHandle(n).scrollTop(!!t):e.scrollTop(!!t)},resize:function(t){t?e.$getByHandle(t).resize():e.resize()},setStatusBarStyle:function(t){"ios"==this.platform&&(t=Number(t)||0,p.style(t))},showTab:function(t){u.showBar(t)},getPath:function(){return r.path()},getNetworkState:function(){return navigator.connection.type},showToast:function(t,e,n){window.plugins&&window.plugins.toast&&window.plugins.toast.showWithOptions({message:t.msg||"",duration:t.time||"short",position:t.position||"center",addPixelsY:t.offset||0,data:t.data||{},styling:{opacity:t.style&&t.style.opa?t.style.opa:.8,backgroundColor:t.style&&t.style.bg?t.style.bg:"#333333",textSize:t.style&&t.style.size?t.style.size:13,textColor:t.style&&t.style.color?t.style.color:"#FFFFFF",cornerRadius:t.style&&t.style.radius?t.style.radius:20,horizontalPadding:t.style&&t.style.hPadding?t.style.hPadding:50,verticalPadding:t.style&&t.style.vPadding?t.style.vPadding:30}},function(t){e&&e(t)},function(t){n&&n()})},ajax:function(t,e,o,i){this.getNetworkState()!=Connection.NONE?n({url:t+"?callback=JSON_CALLBACK",method:"JSONP",params:e}).then(function(t){o&&o(t)},function(t){i&&i(t)}).finally(function(){}):this.showToast({msg:"无网络连接，请检查您的网络是否正常",position:"bottom"})},call:function(t,e){var n=this;window.plugins&&window.plugins.CallNumber?(t="ios"==n.platform?"tel:"+t:t,window.plugins.CallNumber.callNumber(function(){e&&e()},function(){n.showToast({msg:"拨打电话失败"})},t)):n.showToast({msg:"拨打电话失败"})}}}]).factory("$storage",[function(){var t=window.localStorage;return{get:function(e){return!!t.getItem(e)&&JSON.parse(t.getItem(e))},set:function(e,n){"object"==typeof n?t.setItem(e,JSON.stringify(n)):t.setItem(e,n)},remove:function(e){t.removeItem(e)},clear:function(){t.clear()}}}]).factory("$time",["$interval",function(t){return{format:function(t){return 1==(t=t.toString()).length?"0"+t:t},countDown:function(e,n){var o,i=this,a=e.second?Number(e.second):0,s=e.minute?Number(e.minute):0,c=e.hour?Number(e.hour):0;o=t(function(){if(0==a)if(s>0)a=60,s--;else{if(!(c>0))return t.cancel(o),void(n&&n());a=60,s=59,c--}a--,e.hour=i.format(c),e.minute=i.format(s),e.second=i.format(a)},1e3)},toTime:function(t){var e={},n=Math.floor(t/1e3);return e.hour=Math.floor(n/3600),e.minute=Math.floor(n%3600/60),e.second=n-60*e.minute-3600*e.hour,e}}}]),angular.module("filters",[]).filter("price",[function(){return function(t){return isNaN(Number(t))?t:"￥"+Number(t).toFixed(2)}}]),angular.module("directives",[]).directive("hideTab",["$icu",function(t){return{restrict:"A",link:function(e,n,o){e.$on("$ionicView.beforeEnter",function(){t.showTab("false"==o.hideTab)})}}}]).directive("statusBar",["$icu",function(t){return{restrict:"A",link:function(e,n,o){e.$on("$ionicView.beforeEnter",function(){t.setStatusBarStyle(+o.statusBar)})}}}]).directive("carousel",["$icu","localImgUrl",function(t,e){return{restrict:"E",replace:!0,scope:{images:"=",click:"&"},template:'<div class="carousel"><ion-slide-box show-pager="true" auto-play="true" does-continue="true" slide-interval="3000"><ion-slide ng-repeat="img in images"><img ng-click="click()" ng-src="'+e+'{{img}}" width="100%"/></ion-slide></ion-slide-box></div>'}}]).directive("sumBar",["$icu","Carts",function(t,e){return{restrict:"E",replace:!0,scope:{pay:"&",count:"@",total:"@"},template:'<div class="bar row row-center bar-footer bar-light sum-bar"><div class="col col-67"><button class="button button-icon icon ion-ios-cart inline-center" ng-click="goCart()"><span class="round-badge badge-assertive">{{count}}</span></button><span class="inline-center">合计：<i>{{total | price}}</i></span></div><div class="col col-33 tac" ng-click="pay()"><span class="inline-center">结算</span></div></div>',compile:function(e,n){return 1==n.hasTabs&&e.addClass("has-tabs"),1!=n.showCart&&e.find("button").remove(),function(e,n,o){e.goCart=function(){t.go("tab.carts")}}}}}]),angular.module("controllers",[]).controller("DashCtrl",["$scope",function(t){}]).controller("ChatsCtrl",["$scope","Chats",function(t,e){t.chats=e.all(),t.remove=function(t){e.remove(t)}}]).controller("ChatDetailCtrl",["$scope","$stateParams","Chats",function(t,e,n){t.chat=n.get(e.chatId)}]).controller("AccountCtrl",["$scope",function(t){t.settings={enableFriends:!0}}]);var app=angular.module("syhp",["ionic","ngCordova","configs","services","filters","directives","controllers"]);app.run(["$ionicPlatform","$icu","$rootScope","$ionicHistory","$timeout",function(t,e,n,o,i){t.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault(),document.addEventListener("offline",function(){e.showToast({msg:"网络已断开，请检查网络连接"})},!1),document.addEventListener("online",function(){e.showToast({msg:"网络已连接"})},!1)}),t.registerBackButtonAction(function(t){return"/tab/login"==e.getPath()||"/tab/recommend"==e.getPath()?n.backButtonPressedOnceToExit?ionic.Platform.exitApp():(n.backButtonPressedOnceToExit=!0,e.showToast({msg:"再按一次返回键退出应用"}),i(function(){n.backButtonPressedOnceToExit=!1},2e3)):o.backView()?e.back():(n.backButtonPressedOnceToExit=!0,e.showToast({msg:"再按一次返回键退出应用"}),i(function(){n.backButtonPressedOnceToExit=!1},2e3)),t.preventDefault(),!1},101)}]),app.config(["$stateProvider","$urlRouterProvider","$ionicConfigProvider",function(t,e,n){n.tabs.style("standard"),n.tabs.position("bottom"),n.templates.maxPrefetch(20),n.spinner.icon("ios-small"),n.backButton.text(""),n.backButton.previousTitleText(!1),n.form.toggle("large"),n.form.checkbox("circle"),n.views.swipeBackEnabled(!1),n.views.forwardCache(!1),n.views.maxCache(20),t.state("tab",{url:"/tab",abstract:!0,templateUrl:"templates/tabs.html"}).state("tab.dash",{url:"/dash",views:{"tab-dash":{templateUrl:"templates/tab-dash.html",controller:"DashCtrl"}}}).state("tab.chats",{url:"/chats",views:{"tab-chats":{templateUrl:"templates/tab-chats.html",controller:"ChatsCtrl"}}}).state("tab.chat-detail",{url:"/chats/:chatId",views:{"tab-chats":{templateUrl:"templates/chat-detail.html",controller:"ChatDetailCtrl"}}}).state("tab.account",{url:"/account",views:{"tab-account":{templateUrl:"templates/tab-account.html",controller:"AccountCtrl"}}}),e.otherwise("/tab/dash")}]),app.run(["$templateCache",function(t){t.put("templates/chat-detail.html",'\x3c!--\n  This template loads for the \'tab.friend-detail\' state (app.js)\n  \'friend\' is a $scope variable created in the FriendsCtrl controller (controllers.js)\n  The FriendsCtrl pulls data from the Friends service (service.js)\n  The Friends service returns an array of friend data\n--\x3e\n<ion-view view-title="{{chat.name}}">\n  <ion-content class="padding">\n    <img ng-src="{{chat.face}}" style="width: 64px; height: 64px">\n    <p>\n      {{chat.lastText}}\n    </p>\n  </ion-content>\n</ion-view>\n'),t.put("templates/tab-account.html",'<ion-view view-title="Account">\n  <ion-content>\n    <ion-list>\n      <ion-toggle ng-model="settings.enableFriends">\n        Enable Friends\n      </ion-toggle>\n    </ion-list>\n  </ion-content>\n</ion-view>\n'),t.put("templates/tab-chats.html",'<ion-view view-title="Chats">\n  <ion-content>\n    <ion-list>\n      <ion-item class="item-remove-animate item-avatar item-icon-right" ng-repeat="chat in chats" type="item-text-wrap" href="#/tab/chats/{{chat.id}}">\n        <img ng-src="{{chat.face}}">\n        <h2>{{chat.name}}</h2>\n        <p>{{chat.lastText}}</p>\n        <i class="icon ion-chevron-right icon-accessory"></i>\n\n        <ion-option-button class="button-assertive" ng-click="remove(chat)">\n          Delete\n        </ion-option-button>\n      </ion-item>\n    </ion-list>\n  </ion-content>\n</ion-view>\n'),t.put("templates/tab-dash.html",'<ion-view view-title="Dashboard">\n  <ion-content class="padding">\n    <h2>Welcome to Ionic</h2>\n    <p>\n    This is the Ionic starter for tabs-based apps. For other starters and ready-made templates, check out the <a href="http://market.ionic.io/starters" target="_blank">Ionic Market</a>.\n    </p>\n    <p>\n      To edit the content of each tab, edit the corresponding template file in <code>www/templates/</code>. This template is <code>www/templates/tab-dash.html</code>\n    </p>\n    <p>\n    If you need help with your app, join the Ionic Community on the <a href="http://forum.ionicframework.com" target="_blank">Ionic Forum</a>. Make sure to <a href="http://twitter.com/ionicframework" target="_blank">follow us</a> on Twitter to get important updates and announcements for Ionic developers.\n    </p>\n    <p>\n      <b>Psst!</b> - Try <a href="http://view.ionic.io/">Ionic View</a> to easily share and test your app with clients and co-workers.\n    </p>\n  </ion-content>\n</ion-view>\n'),t.put("templates/tabs.html",'\x3c!--\nCreate tabs with an icon and label, using the tabs-positive style.\nEach tab\'s child <ion-nav-view> directive will have its own\nnavigation history that also transitions its views in and out.\n--\x3e\n<ion-tabs class="tabs-icon-top tabs-color-active-positive">\n\n  \x3c!-- Dashboard Tab --\x3e\n  <ion-tab title="Status" icon-off="ion-ios-pulse" icon-on="ion-ios-pulse-strong" href="#/tab/dash">\n    <ion-nav-view name="tab-dash"></ion-nav-view>\n  </ion-tab>\n\n  \x3c!-- Chats Tab --\x3e\n  <ion-tab title="Chats" icon-off="ion-ios-chatboxes-outline" icon-on="ion-ios-chatboxes" href="#/tab/chats">\n    <ion-nav-view name="tab-chats"></ion-nav-view>\n  </ion-tab>\n\n  \x3c!-- Account Tab --\x3e\n  <ion-tab title="Account" icon-off="ion-ios-gear-outline" icon-on="ion-ios-gear" href="#/tab/account">\n    <ion-nav-view name="tab-account"></ion-nav-view>\n  </ion-tab>\n\n\n</ion-tabs>\n')}]);